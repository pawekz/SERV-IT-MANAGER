# Azure MySQL Database Configuration
spring.datasource.url=jdbc:mysql://${MYSQL_SERVER}:3306/${MYSQL_DATABASE}?useSSL=true&requireSSL=true&serverTimezone=Asia/Manila&useServerPrepStmts=true&cachePrepStmts=true&prepStmtCacheSize=250&prepStmtCacheSqlLimit=2048&rewriteBatchedStatements=true&useLocalSessionState=true&elideSetAutoCommits=true&maintainTimeStats=false&useUnicode=true&characterEncoding=utf8&allowPublicKeyRetrieval=true&nullCatalogMeansCurrent=true
spring.datasource.driver-class-name=com.mysql.cj.jdbc.Driver
spring.datasource.username=${MYSQL_USERNAME}
spring.datasource.password=${MYSQL_PASSWORD}

# JPA Configuration for Azure MySQL
spring.jpa.show-sql=false
#spring.jpa.hibernate.ddl-auto=validate
spring.jpa.hibernate.ddl-auto=update
spring.jpa.database-platform=org.hibernate.dialect.MySQLDialect

# Production logging
logging.level.org.springframework.web=WARN
logging.level.org.hibernate.SQL=WARN
logging.level.com.servit.servit=INFO

# MySQL specific configuration for HikariCP / Optimization
spring.datasource.hikari.connection-test-query=SELECT 1
spring.datasource.hikari.minimum-idle=5
spring.datasource.hikari.maximum-pool-size=10
spring.datasource.hikari.connection-timeout=30000
spring.datasource.hikari.idle-timeout=600000
spring.datasource.hikari.max-lifetime=1800000
spring.datasource.hikari.leak-detection-threshold=60000
spring.datasource.hikari.pool-name=ServitHikariPool
# auto-commit default (true) is fine - Spring's @Transactional handles transaction boundaries
# Setting to false requires ALL methods to have @Transactional, which is not the case in this codebase
spring.datasource.hikari.register-mbeans=true

# Timezone configuration (for the database)
spring.jpa.properties.hibernate.jdbc.time_zone=Asia/Manila

# Hibernate Performance Optimization
spring.jpa.properties.hibernate.jdbc.batch_size=20
spring.jpa.properties.hibernate.order_inserts=true
spring.jpa.properties.hibernate.order_updates=true
spring.jpa.properties.hibernate.jdbc.batch_versioned_data=true
spring.jpa.properties.hibernate.generate_statistics=false
spring.jpa.properties.hibernate.query.plan_cache_max_size=2048
spring.jpa.properties.hibernate.query.plan_parameter_metadata_max_size=128
spring.jpa.properties.hibernate.jdbc.fetch_size=50
spring.jpa.properties.hibernate.max_fetch_depth=3
spring.jpa.properties.hibernate.default_batch_fetch_size=10
